spring.application.name=management_system

server.port=8080
# ===============================
# DATABASE CONFIG
# ===============================
spring.datasource.url=jdbc:postgresql://localhost:5432/management_system
spring.datasource.username=postgres
spring.datasource.password=postgres

# Driver
spring.datasource.driver-class-name=org.postgresql.Driver

# ===============================
# JPA / HIBERNATE
# ===============================
# spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Dialect PostgreSQL
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Enable PostgreSQL ENUM type support
spring.jpa.properties.hibernate.type.preferred_jdbc_type_for_enum=NAMED_ENUM

# ===============================
# FLYWAY MIGRATION
# ===============================
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
# Allow out of order migrations to execute V14 before V11 validation
spring.flyway.outOfOrder=true

# i18n
spring.messages.basename=i18n/messages
spring.messages.encoding=UTF-8
spring.messages.fallback-to-system-locale=false
spring.web.locale=vi
spring.web.locale-resolver=accept_header

# Physical path on D drive for uploaded files
file.upload-dir=uploads

# Directory to store files after soft deletion
file.remove-dir=remove

# Maximum upload file size in bytes (5 MB)
file.upload.max-size=5242880
file.size.kb=1024
file.size.mb=1024

# avatar default 
file.default-avatar=/default/avatar.jpg

# role default
default-role-id: 22222222-2222-2222-2222-222222222222

# Mail server
mail.host=smtp.gmail.com
mail.port=587
mail.username=danghoangtest1@gmail.com
mail.password=rnsmddbxngmybmat

# Mail properties
mail.properties.mail.smtp.auth=true
mail.properties.mail.smtp.starttls.enable=true

# Activation
app.frontend-url=http://localhost:5173
activation.expiry-minutes=10

spring.messages.basename=i18n/messages
spring.messages.encoding=UTF-8

# Config Google/ Facebook auth
# ================= GOOGLE =================
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}
spring.security.oauth2.client.registration.google.scope=email,profile
# spring.security.oauth2.client.registration.google.redirect-uri = "{baseUrl}/oauth2/callback/{registrationId}

# ================= FACEBOOK =================
spring.security.oauth2.client.registration.facebook.client-id=${FACEBOOK_CLIENT_ID}
spring.security.oauth2.client.registration.facebook.client-secret=${FACEBOOK_CLIENT_SECRET}
spring.security.oauth2.client.registration.facebook.scope=email,public_profile
# spring.security.oauth2.client.registration.facebook.redirect-uri = "{baseUrl}/oauth2/callback/{registrationId}"

spring.security.oauth2.client.provider.facebook.authorization-uri=https://www.facebook.com/v18.0/dialog/oauth
spring.security.oauth2.client.provider.facebook.token-uri=https://graph.facebook.com/v18.0/oauth/access_token
spring.security.oauth2.client.provider.facebook.user-info-uri=https://graph.facebook.com/me?fields=id,name,email
spring.security.oauth2.client.provider.facebook.user-name-attribute=id

# Sau khi xác thực thành công với OAuth2 Provider,
# backend sẽ redirect về các URI được phép bên dưới
# (KHÔNG dùng cookie – phù hợp cho web & mobile)
app.oauth2.authorized-redirect-uris[0]=http://localhost:5173/oauth2/redirect
app.oauth2.authorized-redirect-uris[1]=luv-service://oauth2/redirect

# Cloudinary Configuration
cloudinary.cloud-name=dhv7v0enl
cloudinary.api-key=321888329748168
cloudinary.api-secret=tJYJsxpU4KbSNEjJju49n_06l3c
cloudinary.upload-folder=do_an_management/avatars

# Enable proper 404 handling (throw NoHandlerFoundException instead of default 404)
spring.mvc.throw-exception-if-no-handler-found=true
spring.web.resources.add-mappings=false

# File Upload Configuration
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=5MB

# AI provider configuration
ai.provider=gemini
ai.gemini.api-key=AIzaSyBrtOC1p8f43BN07sL8rMFHdxVKaR4uelM
ai.gemini.model=gemini-2.5-flash

ai.openai.api-key=${OPENAI_API_KEY:}
ai.openai.model=gpt-4o-mini
ai.timeout-ms=20000

# ===============================
# CHATBOT CONFIGURATION
# ===============================
# Similarity threshold for knowledge retrieval (0.0-1.0)
# Higher values = more strict matching
chatbot.similarity-threshold=0.65

# Maximum number of chat history messages to include in context
chatbot.max-history=10

# Maximum number of knowledge references to return
chatbot.max-references=7

# ===============================
# CACHE CONFIGURATION
# ===============================
# Cache knowledge base for 30 minutes
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=100,expireAfterWrite=30m

# ===============================
# LOGGING CONFIGURATION
# ===============================
# Enable detailed logging for chat services
logging.level.com.management_system.service.impl.ChatServiceImpl=DEBUG
logging.level.com.management_system.service.impl.IntentDetectionServiceImpl=DEBUG
logging.level.com.management_system.service.impl.AiGatewayService=DEBUG